@startuml VSCode_Startup_Sequence

title VSCode Startup Sequence for Laminar Form Derivation

actor User
participant "VSCode" as vscode
participant "Task: demo" as demo
participant "Task: setup" as setup
participant "Task: runDemo" as runDemo
participant "Task: fastLink" as fastLink
participant "Task: npmDev" as npmDev
participant "setup.sc" as setupScript
participant "fastLink.sh" as fastLinkScript
participant "npmDev.sh" as npmDevScript

User -> vscode: Opens project folder
vscode -> demo: Triggers "demo" task\n(runOn: folderOpen)
demo -> setup: Executes "setup" task\n(sequence)
demo -> runDemo: Executes "runDemo" task\n(sequence)

setup -> setupScript: Runs ./scripts/setup.sc
setupScript -> setupScript: Checks if build-env.sh needs regeneration
setupScript -> setupScript: Checks if node modules need installation
setupScript --> setup: Returns completion

runDemo -> fastLink: Executes "fastLink" task\n(parallel)
runDemo -> npmDev: Executes "npmDev" task\n(parallel)

fastLink -> fastLinkScript: Runs ./scripts/fastLink.sh
fastLinkScript -> fastLinkScript: Waits for npm dev server marker
fastLinkScript -> fastLinkScript: Waits for main.js generation
fastLinkScript -> fastLinkScript: Runs sbt ~client/fastLinkJS
fastLinkScript --> fastLink: Returns completion

npmDev -> npmDevScript: Runs ./scripts/npmDev.sh
npmDevScript -> npmDevScript: Creates npm dev server marker
npmDevScript -> npmDevScript: Runs npm run dev in client
npmDevScript --> npmDev: Returns completion

@enduml
